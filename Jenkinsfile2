// set github commit status 
void setBuildStatus(String message, String state) {
  step([
      $class: "GitHubCommitStatusSetter",
      reposSource: [$class: "ManuallyEnteredRepositorySource", url: "${GIT_URL}"],
      contextSource: [$class: "ManuallyEnteredCommitContextSource", context: "build-status"],
      errorHandlers: [[$class: "ChangingBuildStatusErrorHandler", result: "UNSTABLE"]],
      statusResultSource: [ $class: "ConditionalStatusResultSource", results: [[$class: "AnyBuildResult", message: message, state: state]] ]
  ]);
}
void whateverFunction() {
    sh '''
    	echo "my name is ${Name},age :${AGE}"
	date
	ifconfig
    '''
}
pipeline{
    agent any
    // github credentials
    environment{
        APPNAME = "eigen-app" 
	AGE="18"
    }
    stages{
      stage("test1-${env.APPNAME}"){
	environment{
	    Name = "wangfeihaha"
	}
        steps{
          echo "${GIT_URL}"
          whateverFunction()
        }
      }
      stage("test2-"){
	 environment{
	    Name = "lisi"
	 } 	  
	 when {
	      environment name: 'GIT_BRANCH', value: 'origin/master' 
	  }
          steps{
              // pull code
	      sh 'git clean -fdx'
              checkout scm
	      sh 'printenv'
	      //whateverFunction()
          }
    }
  }
}
